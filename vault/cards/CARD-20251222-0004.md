---
id: CARD-20251222-0004
type: debug_playbook
status: validated
created_at: 2025-12-22
last_verified_at: 2025-12-22
confidence: high
scope: "Git Bash 脚本中 mktemp 临时文件的安全使用"
tags:
  - debug
  - git-bash
  - windows
  - mktemp
  - prevention
sensitivity: public
evidence_refs:
  - EVI-20251222-0002#loc:prevention
sources: []
---

## Claim

在 Git Bash 脚本中使用 `mktemp` 创建临时文件后，应立即用 `cygpath -m` 转换路径，避免后续传递给 Windows 程序时出现路径识别错误。

## Evidence

根据 EVI-20251222-0002#loc:prevention：`mktemp` 返回 MSYS2 虚拟路径 `/tmp/tmp.xxx`，若直接传递给 python.exe 等 Windows 程序，会导致 FileNotFoundError。

推荐模式：
```bash
create_temp_file() {
    local temp=$(mktemp)
    cygpath -m "$temp"
}
local win_temp=$(create_temp_file)
```

## Transferable Rule

**mktemp 即转换。** 封装一个 `create_temp_file` 函数，返回已转换的 Windows 路径。所有需要跨层使用的临时文件都通过此函数创建，从源头消除路径兼容问题。
