# Web 调研：后端技术栈深度机理分析

## Research Questions

1. **Redis 单线程机理**: Redis 单线程事件循环如何实现高并发？底层原理是什么？
2. **Nacos vs Zookeeper**: 服务发现场景下的 CAP 取舍和适用边界
3. **Spring Boot 学习路径**: 2025 年后端技术栈的学习优先级和路线图

## Sources

| Source | URL | Trust Reason |
|--------|-----|--------------|
| Ricardo Ferreira / AWS Community | https://riferrei.com/the-engineering-wisdom-behind-rediss-single-threaded-design/ | AWS 社区博客，深度技术分析 |
| thuva4 Blog | https://thuva4.com/blog/part-1-the-core-of-redis/ | Redis 深度剖析系列，技术详实 |
| Karim Albakry / Medium | https://medium.com/@karim.albakry/in-depth-comparison-of-distributed-coordination-tools-consul-etcd-zookeeper-and-nacos-a6f8e5d612a6 | 分布式协调工具对比，中立分析 |
| Charles Wan / Medium | https://charleswan111.medium.com/comparing-service-discovery-and-coordination-tools-etcd-consul-eureka-nacos-polaris-157820eb1810 | 全面对比七种服务发现工具 |
| Nacos 官网 | https://nacos.io/en/blog/faq/nacos-user-question-history10484/ | 官方文档，CAP 选型建议 |
| Amigoscode | https://amigoscode.com/blogs/spring-boot-roadmap-2025 | 2025 Spring Boot 学习路线图 |
| CodingShuttle | https://www.codingshuttle.com/blogs/best-way-to-master-spring-boot-a-complete-roadmap-2025/ | 完整学习路径，行业标准 |

## Findings

### 1. Redis 单线程事件循环机理

#### 核心架构
- **Reactor 模式**: Redis 基于 Reactor 模式，单线程通过 I/O 多路复用（epoll/kqueue）同时监听数千个客户端连接
- **事件驱动**: 事件循环检测到 I/O 就绪后，调用对应回调函数非阻塞处理，立即处理下一个事件

#### 两类事件
1. **File Events**: 客户端 socket 的 I/O 事件（读/写就绪触发处理器）
2. **Time Events**: 定时任务（如键过期检查），存储在链表中，每次循环检查

#### 为什么单线程快？
- **无锁竞争**: 不需要加锁、无上下文切换、无竞态条件
- **顺序执行**: CPU 专注于顺序执行命令，无中断
- **内存操作**: O(1) 数据结构（哈希表、跳表），内存访问比磁盘快 10 万倍

#### 单线程的权衡
- **长命令阻塞**: `KEYS *` 或复杂 Lua 脚本会阻塞所有客户端
- **缓解措施**: 命令超时限制、SCAN 替代 KEYS、Lua 脚本超时、后台任务处理持久化

#### Redis 6.0+ I/O 线程
- I/O 线程仅用于 socket 读写卸载，命令执行仍是单线程
- Redis 8 通过精细优化实现 5.4%–87.4% 延迟降低（未改变核心架构）

### 2. Nacos vs Zookeeper 对比

#### CAP 定位差异
| 维度 | Nacos | Zookeeper |
|------|-------|-----------|
| CAP 偏好 | AP（可配置） | CP |
| 协议 | Raft / Distro | ZAB |
| 适用场景 | 服务发现优先 | 分布式协调优先 |

#### 功能对比
| 功能 | Nacos | Zookeeper |
|------|-------|-----------|
| 服务发现 | 原生支持，健康检查 | 通过临时节点实现 |
| 配置管理 | 支持版本、分组、实时推送 | 有限，非主要功能 |
| 多数据中心 | 原生支持 | 需额外配置 |
| Watch 机制 | 长轮询 | 服务端推送 |

#### 选型建议
- **选 Nacos**: 统一服务发现+配置管理，阿里生态（Dubbo），AP 优先场景
- **选 Zookeeper**: Hadoop 生态，强一致性需求，分布式锁/选主场景

### 3. 2025 Spring Boot 学习路径

#### 行业标准
- 2025 年后端主流: Java 17+, Spring Boot 3, Hibernate 6
- 微服务和云原生架构成为常态

#### 推荐学习顺序

1. **Java 基础** → OOP、集合框架、异常处理
2. **Spring Boot 核心** → IoC、DI、AutoConfiguration、REST API
3. **数据层** → Spring Data JPA、MySQL/PostgreSQL
4. **缓存** → Redis 集成
5. **消息队列** → Kafka/RabbitMQ
6. **微服务** → Spring Cloud（服务发现、配置中心、网关）
7. **容器化** → Docker → Kubernetes（按需）
8. **测试** → JUnit 5、Mockito、集成测试
9. **DevOps** → CI/CD、监控（Actuator）、日志（ELK）

#### 关键里程碑
- **入门**: REST API + MySQL + 基础 CRUD
- **进阶**: Redis 缓存 + 消息队列 + 微服务拆分
- **生产就绪**: 容器化 + CI/CD + 监控告警

## Caveats

- Redis I/O 线程特性在 6.0 引入，旧文档可能未覆盖
- Nacos AP 模式是默认配置，也可切换为 CP 模式
- 学习路径因个人背景和目标岗位略有差异，非唯一标准
- 2025 年技术栈可能随 GraalVM、Virtual Threads (Java 21) 等新特性演变
